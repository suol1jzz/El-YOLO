# Ultralytics YOLO ğŸš€, AGPL-3.0 license
# ä¿®æ”¹ç‰ˆæœ¬ï¼šç§»é™¤ C2PSA æ¨¡å— (åŸå±‚8)

# Parameters
nc: 80
scales: # è°ƒæ•´ depth ç³»æ•°ä»¥åŒ¹é…å±‚æ•°å‡å°‘
  # [depth, width, max_channels]
  n: [0.50, 0.25, 1024] # depth å‡å°‘çº¦ 0.1 (åŸ319å±‚ â†’ 317å±‚)
  s: [0.50, 0.50, 1024]
  m: [0.50, 1.00, 512]
  l: [1.00, 1.00, 512]
  x: [1.00, 1.50, 512]

backbone:
  # [from, repeats, module, args]
  - [-1, 1, Conv, [64, 6, 2, 2]] # 0-P1/2
  - [-1, 1, Conv, [128, 3, 2]]   # 1-P2/4
  - [-1, 3, C3, [128]]           # 2

  - [-1, 1, Conv, [256, 3, 2]]   # 3-P3/8
  - [-1, 6, C3, [256]]           # 4

  - [-1, 1, Conv, [512, 3, 2]]   # 5-P4/16
  - [-1, 9, C3, [512]]           # 6
  - [-1, 1, SPPF, [1024, 5]]     # 7-P5/32 (åŸå±‚8å˜ä¸ºå±‚7)

# åˆ é™¤åŸå±‚8çš„ C2PSA

head:
  # ----------------- Stage: è·¨å±‚èåˆ -----------------
  # æ‰€æœ‰åŸå±‚å· >=8 çš„å¼•ç”¨éœ€å‡1
  - [ 2, 1, Conv,[ 256, 1, 1]]         # 8-p3/16 (åŸå±‚9)
  - [ 4, 1, Conv,[ 512, 1, 1 ]]        # 9-p4/16 (åŸå±‚10)
  - [ 7, 1, Conv,[ 1024, 1, 1]]        # 10-p5/32 (åŸå±‚11å¼•ç”¨æ”¹ä¸ºå½“å‰å±‚7)

  - [9, 1, ResUpDownSample, [256,"up"]] # 11 (åŸå±‚12)
  - [[8,11], 1, FeatureFusion,[[256,256],"asff2"]] # 12 (åŸå±‚13)

  - [8, 1, ResUpDownSample, [512,"down"]] #13 (åŸå±‚14)
  - [[9,13], 1, FeatureFusion,[[512,512],"asff2"]] #14 (åŸå±‚15)
  - [7, 1, ResUpDownSample, [512,"up"]] #15 (åŸå±‚16å¼•ç”¨æ”¹ä¸ºå±‚7)
  - [[15,14], 1, ACBiFPN,[512,2]] #16 (åŸå±‚17)

  - [16, 1, ResUpDownSample,[256,"up"]] #17 (åŸå±‚18)
  - [[17,12], 1, ACBiFPN, [256,2]] #18 (åŸå±‚19)
  - [-1, 2, C3k2_DWSConv, [256, False]] #19 (åŸå±‚20)

  - [16, 2, C3k2_DWSConv, [512, False]] #20 (åŸå±‚21)

  - [20, 1, ResUpDownSample,[256,"up"]] #21 (åŸå±‚22)
  - [[21,19], 1, FeatureFusion,[[256,256],"asff2"]] #22 (åŸå±‚23)

  - [19, 1, ResUpDownSample, [512,"down"]] #23 (åŸå±‚24)
  - [10, 1, ResUpDownSample, [512,"up"]] #24 (åŸå±‚25å¼•ç”¨æ”¹ä¸ºå±‚10)
  - [[20,23,24], 1 ,FeatureFusion, [[512,512],"asff3"]] #25 (åŸå±‚26)

  - [20, 1, ResUpDownSample, [1024,"down"]] #26 (åŸå±‚27)
  - [[10,26], 1, FeatureFusion,[[1024,1024],"asff2"]] #27 (åŸå±‚28)
  - [27, 2, C3k2_DWSConv, [1024, False]] #28 (åŸå±‚29)

  - [27, 1, ResUpDownSample, [512,"up"]] #29 (åŸå±‚30)
  - [[25,29], 1, ACBiFPN,[512,2]] #30 (åŸå±‚31)
  - [27, 2, C3k2_DWSConv, [512, False]] #31 (åŸå±‚32)

  - [30, 1, ResUpDownSample, [256,"up"]] #32 (åŸå±‚33)
  - [[22,32], 1, ACBiFPN,[256,2]] #33 (åŸå±‚34)
  - [33, 2, C3k2_DWSConv, [256, False]] #34 (åŸå±‚35)

  # ----------------- æ£€æµ‹å¤´è¿æ¥ -----------------
  - [[34, 31, 28], 1, Detect, [nc]] # å¯¹åº”P3/8, P4/16, P5/32